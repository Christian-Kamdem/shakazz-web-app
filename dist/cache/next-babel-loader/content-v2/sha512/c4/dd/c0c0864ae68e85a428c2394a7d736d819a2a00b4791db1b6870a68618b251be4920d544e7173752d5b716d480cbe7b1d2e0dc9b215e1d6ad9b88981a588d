{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/Users/apple/Documents/Projects/itguymax/shakazz/dev/shakaa-web-app-new-version/shakazz-web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/apple/Documents/Projects/itguymax/shakazz/dev/shakaa-web-app-new-version/shakazz-web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useState, useRef } from 'react';\nimport { useRouter } from 'next/router';\nimport Bleu from '../../../layouts/Bleu';\nimport Link from 'next/link';\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport { Card, Button, CardBody, FormGroup, InputGroup, Input } from 'reactstrap';\nimport Captcha from '../../../components/Captcha';\nimport Sinput from '../../../components/forms/Sinput';\nimport { resetPasswordSchema } from '../../../validations';\nimport { resetPassword } from '../../../services/auth.service';\n\nfunction ForgotPassword() {\n  var _router$query, _router$query2;\n\n  var recaptchaRef = useRef();\n  var router = useRouter();\n\n  var _useForm = useForm({\n    resolver: yupResolver(resetPasswordSchema)\n  }),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      watch = _useForm.watch,\n      errors = _useForm.errors;\n\n  var _useState = useState(false),\n      show = _useState[0],\n      setShow = _useState[1];\n\n  var _useState2 = useState(false),\n      showc = _useState2[0],\n      setShowc = _useState2[1];\n\n  var _useState3 = useState(false),\n      isUpdate = _useState3[0],\n      updateUserpassword = _useState3[1];\n\n  var _useState4 = useState(false),\n      verified = _useState4[0],\n      setVerified = _useState4[1];\n\n  var _useState5 = useState(false),\n      submitting = _useState5[0],\n      setSubmitting = _useState5[1];\n\n  var _useState6 = useState(null),\n      errormsg = _useState6[0],\n      setErrormsg = _useState6[1];\n\n  var _useState7 = useState(null),\n      successmsg = _useState7[0],\n      setSuccessmsg = _useState7[1];\n\n  var executeCaptcha = function executeCaptcha() {\n    return setVerified(!verified);\n  };\n\n  var handleToggleshow = function handleToggleshow() {\n    return setShow(!show);\n  };\n\n  var handleToggleshowc = function handleToggleshowc() {\n    return setShowc(!showc);\n  };\n\n  if (router.route !== \"/auth/forgotPassword/reset\") {\n    return;\n  }\n\n  var userId = (_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.id;\n  var token = (_router$query2 = router.query) === null || _router$query2 === void 0 ? void 0 : _router$query2.token;\n  console.log('route', router);\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n      var userdata, password, datares, _data, error, success, message;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!verified) {\n                _context.next = 19;\n                break;\n              }\n\n              setSubmitting(true);\n              password = data.password;\n              userdata = {\n                password: password,\n                userId: userId,\n                token: token\n              };\n              _context.prev = 4;\n              _context.next = 7;\n              return resetPassword(userdata);\n\n            case 7:\n              datares = _context.sent;\n              console.log('login data', datares);\n              _data = datares.data, error = datares.error, success = datares.success, message = datares.message;\n\n              if (error && !success) {\n                setSuccessmsg(null);\n                setErrormsg(message);\n              } else {\n                setErrormsg(null);\n                setSuccessmsg(message);\n                updateUserpassword(true);\n              }\n\n              console.log(\"data\", _data);\n              _context.next = 17;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](4);\n              console.log(\"error\", _context.t0);\n\n            case 17:\n              _context.next = 20;\n              break;\n\n            case 19:\n              alert(\"Vous  n'Ãªtes pas humain\");\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 14]]);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(\"h3\", {\n      style: {\n        font: 'normal normal bold 30px/35px Ubuntu',\n        color: '#fff',\n        letterSpacing: '0px',\n        marginBottom: '50px'\n      },\n      children: \"R\\xE9cup\\xE9ration de votre mot de passe\"\n    }), isUpdate ? /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsx(\"h2\", {\n        className: \"font-weight-bold\",\n        style: {\n          color: '#fff'\n        },\n        children: \"Connectez vous!\"\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        style: {\n          color: '#fff'\n        },\n        children: [\"Votre mot de passe a \\xE9t\\xE9 restaur\\xE9\", /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(Link, {\n          href: \"/auth/login\",\n          children: /*#__PURE__*/_jsx(\"small\", {\n            style: {\n              color: '#fff',\n              cursor: 'pointer'\n            },\n            children: \"Cliquez ici\"\n          })\n        })]\n      })]\n    }) : /*#__PURE__*/_jsx(\"form\", {\n      onSubmit: handleSubmit(onSubmit),\n      className: \"d-flex justify-content-center align-items-center\",\n      children: /*#__PURE__*/_jsxs(Card, {\n        style: {\n          width: '450px'\n        },\n        children: [/*#__PURE__*/_jsx(\"small\", {\n          style: {\n            font: 'normal normal bold 14px/16px Ubuntu',\n            margin: '10px auto 0px auto'\n          },\n          children: \"Remplissez le formulaire\"\n        }), /*#__PURE__*/_jsxs(CardBody, {\n          children: [/*#__PURE__*/_jsx(Sinput, {\n            label: \"Nouveau mot de passe\",\n            placeholder: \"Entrez le nouveau mot de passe\",\n            type: show ? \"text\" : \"password\",\n            name: \"password\",\n            icon: show ? \"fa fa-eye\" : \"fa fa-eye-slash\",\n            handleToggleshow: handleToggleshow,\n            append: true,\n            register: register\n          }), errors.password && /*#__PURE__*/_jsx(\"div\", {\n            className: \"text-muted font-italic\",\n            children: /*#__PURE__*/_jsx(\"span\", {\n              className: \"text-danger font-weight-700\",\n              children: errors.password.message\n            })\n          }), /*#__PURE__*/_jsx(Sinput, {\n            label: \"Confirmez le mot de passe\",\n            placeholder: \"Entrez le mot de passe\",\n            type: showc ? \"text\" : \"password\",\n            name: \"confirmpassword\",\n            icon: showc ? \"fa fa-eye\" : \"fa fa-eye-slash\",\n            handleToggleshow: handleToggleshowc,\n            append: true,\n            register: register\n          }), errors.confirmpassword && /*#__PURE__*/_jsx(\"div\", {\n            className: \"text-muted font-italic\",\n            children: /*#__PURE__*/_jsx(\"span\", {\n              className: \"text-danger font-weight-700\",\n              children: errors.confirmpassword.message\n            })\n          }), /*#__PURE__*/_jsx(Captcha, {\n            recaptchaRef: recaptchaRef,\n            onChange: executeCaptcha\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"text-center\",\n            children: [errormsg && /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-muted font-italic\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                className: \"text-danger font-weight-700\",\n                children: errormsg\n              })\n            }), successmsg && /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-muted font-italic\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                className: \"text-success font-weight-700\",\n                children: successmsg\n              })\n            }), /*#__PURE__*/_jsx(Button, {\n              className: \"mt-3 mb-1\",\n              type: \"submit\",\n              style: {\n                width: '50%',\n                backgroundColor: '#679966',\n                borderColor: '#679966'\n              },\n              children: \"Restaurer\"\n            })]\n          })]\n        })]\n      })\n    })]\n  });\n}\n\nForgotPassword.layout = Bleu;\nexport default ForgotPassword;","map":null,"metadata":{},"sourceType":"module"}