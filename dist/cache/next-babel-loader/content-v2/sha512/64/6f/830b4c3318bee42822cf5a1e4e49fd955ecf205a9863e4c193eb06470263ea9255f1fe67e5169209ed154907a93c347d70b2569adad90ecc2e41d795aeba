{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useRef, useState } from \"react\";\nimport { useRouter } from 'next/router';\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport { login } from '../../services/auth.service'; // reactstrap components\n\nimport { Button, Card, CardHeader, CardBody, Form, Row } from \"reactstrap\"; // layout for this page\n\nimport Auth from \"../../layouts/Auth.js\";\nimport Sinput from \"../../components/forms/Sinput\";\nimport Captcha from \"../../components/Captcha\";\nimport { loginSchema } from \"../../validations\";\n\nfunction Login() {\n  const {\n    register,\n    handleSubmit,\n    errors\n  } = useForm({\n    resolver: yupResolver(loginSchema)\n  });\n  const router = useRouter();\n  const recaptchaRef = useRef();\n  const {\n    0: show,\n    1: setShow\n  } = useState(false);\n  const {\n    0: verified,\n    1: setVerified\n  } = useState(false);\n  const {\n    0: submitting,\n    1: setSubmitting\n  } = useState(false);\n  const {\n    0: errormsg,\n    1: setErrormsg\n  } = useState(null);\n  const {\n    0: successmsg,\n    1: setSuccessmsg\n  } = useState(null);\n\n  const handleToggleshow = () => setShow(!show);\n\n  const executeCaptcha = () => setVerified(!verified);\n\n  const onSubmit = async data => {\n    console.log(\"submit\");\n    let userdata;\n\n    if (verified) {\n      setSubmitting(true);\n      const {\n        password,\n        userName\n      } = data;\n      userdata = {\n        password,\n        userName\n      };\n\n      try {\n        let datares = await login(userdata);\n        console.log('login data', datares);\n        const {\n          data,\n          error,\n          success,\n          message\n        } = datares;\n\n        if (error && !success) {\n          setSuccessmsg(null);\n          setErrormsg(message);\n        } else {\n          setErrormsg(null);\n          setSuccessmsg(message);\n          router.push('/portal/dashboard');\n        }\n\n        console.log(\"data\", data);\n      } catch (err) {\n        console.log(\"error\", err);\n      }\n    } else {\n      alert(\"Vous  n'Ãªtes pas humain\");\n    }\n  };\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsx(Row, {\n      children: /*#__PURE__*/_jsxs(Card, {\n        className: \"bg-white container border-0\",\n        style: {\n          minWidth: '100%'\n        },\n        children: [/*#__PURE__*/_jsx(CardHeader, {\n          className: \"bg-transparent px-lg-5 \",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"text-muted mt-2 mb-1\",\n            children: [/*#__PURE__*/_jsx(\"h2\", {\n              style: {\n                marginBottom: '0px'\n              },\n              className: \"text-md-right mb-md-4\",\n              children: \"Inscription\"\n            }), /*#__PURE__*/_jsx(\"a\", {\n              style: {\n                font: 'normal normal bold 42px/48px Ubuntu',\n                color: '#121212'\n              },\n              onClick: e => e.preventDefault(),\n              children: \"Hi, welcome back\"\n            })]\n          })\n        }), /*#__PURE__*/_jsx(CardBody, {\n          className: \"px-lg-5 py-lg-2\",\n          children: /*#__PURE__*/_jsxs(Form, {\n            role: \"form\",\n            onSubmit: handleSubmit(onSubmit),\n            children: [/*#__PURE__*/_jsx(Sinput, {\n              label: \"Nom d'utilisateur\",\n              icon: \"far fa-user\",\n              placeholder: \"Nom d'utilisateur\",\n              type: \"text\",\n              register: register,\n              name: \"userName\",\n              append: true\n            }), errors.userName && /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-muted font-italic\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                className: \"text-danger font-weight-700\",\n                children: errors.userName.message\n              })\n            }), /*#__PURE__*/_jsx(Sinput, {\n              label: \"Mot de passe\",\n              icon: \"fa fa-user\",\n              placeholder: \"Entrer votre mot de passe\",\n              type: show ? \"text\" : \"password\",\n              register: register,\n              name: \"password\",\n              icon: show ? \"fa fa-eye\" : \"fa fa-eye-slash\",\n              handleToggleshow: handleToggleshow,\n              append: true\n            }), errors.password && /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-muted font-italic\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                className: \"text-danger font-weight-700\",\n                children: errors.password.message\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-right \",\n              children: /*#__PURE__*/_jsx(\"a\", {\n                href: \"/auth/forgotPassword\",\n                onClick: e => router.prefetch('/auth/forgotPassword'),\n                children: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"text-muted\",\n                  children: \"Mot de passe oubli\\xE9?\"\n                })\n              })\n            }), /*#__PURE__*/_jsx(Captcha, {\n              recaptchaRef: recaptchaRef,\n              onChange: executeCaptcha\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"text-center\",\n              children: [errormsg && /*#__PURE__*/_jsx(\"div\", {\n                className: \"text-muted font-italic\",\n                children: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"text-danger font-weight-700\",\n                  children: errormsg\n                })\n              }), successmsg && /*#__PURE__*/_jsx(\"div\", {\n                className: \"text-muted font-italic\",\n                children: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"text-success font-weight-700\",\n                  children: successmsg\n                })\n              }), /*#__PURE__*/_jsx(Button, {\n                className: \"mt-3 mb-1\",\n                type: \"submit\",\n                style: {\n                  width: '50%',\n                  backgroundColor: '#679966',\n                  borderColor: '#679966'\n                },\n                children: \"S'identifier\"\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                children: [/*#__PURE__*/_jsx(\"a\", {\n                  href: \"/auth/register\",\n                  onClick: e => e.preventDefault(),\n                  children: /*#__PURE__*/_jsx(\"small\", {\n                    children: \"Vous n'avez pas encore de compte?\"\n                  })\n                }), \" \", /*#__PURE__*/_jsx(\"a\", {\n                  href: \"/auth/register\",\n                  children: /*#__PURE__*/_jsx(\"small\", {\n                    className: \"text-bold font-weight-bold ml-1\",\n                    children: \"S'inscrire\"\n                  })\n                })]\n              })]\n            })]\n          })\n        })]\n      })\n    })\n  });\n}\n\nLogin.layout = Auth;\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}