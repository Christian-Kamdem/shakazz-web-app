{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useRef } from 'react';\nimport { useRouter } from 'next/router';\nimport Bleu from '../../layouts/Bleu';\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport Sinput from \"../../components/forms/Sinput\";\nimport { forgotPasswordSchema } from \"../../validations\";\nimport { requestPasswordReset } from '../../services/auth.service';\nimport { Card, Button, CardBody } from 'reactstrap';\nimport Captcha from '../../components/Captcha';\n\nfunction ForgotPassword() {\n  const {\n    register,\n    handleSubmit,\n    watch,\n    errors\n  } = useForm({\n    resolver: yupResolver(forgotPasswordSchema)\n  });\n  const {\n    0: verified,\n    1: setVerified\n  } = useState(false);\n  const {\n    0: submitting,\n    1: setSubmitting\n  } = useState(false);\n  const {\n    0: errormsg,\n    1: setErrormsg\n  } = useState(null);\n  const {\n    0: successmsg,\n    1: setSuccessmsg\n  } = useState(null);\n  const {\n    0: emailSend,\n    1: setEmail\n  } = useState(false);\n\n  const executeCaptcha = () => setVerified(!verified);\n\n  const onSubmit = async data => {\n    console.log(\"data pw\", data);\n    let userdata;\n\n    if (verified) {\n      setSubmitting(true);\n      const {\n        email\n      } = data;\n      userdata = {\n        email\n      };\n\n      try {\n        let datares = await requestPasswordReset(userdata);\n        console.log('forgot password data', datares);\n        const {\n          data,\n          error,\n          success,\n          message\n        } = datares;\n\n        if (error && !success) {\n          setSuccessmsg(null);\n          setErrormsg(message);\n        } else {\n          setErrormsg(null);\n          setSuccessmsg(message);\n          setEmail(!emailSend);\n        }\n\n        console.log(\"data\", data);\n      } catch (err) {\n        console.log(\"error\", err);\n      }\n    } else {\n      alert(\"Vous  n'êtes pas humain\");\n    }\n  };\n\n  const recaptchaRef = useRef();\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(\"h3\", {\n      style: {\n        font: 'normal normal bold 30px/35px Ubuntu',\n        color: '#fff',\n        letterSpacing: '0px',\n        marginBottom: '50px'\n      },\n      children: \"R\\xE9cup\\xE9ration de votre mot de passe\"\n    }), emailSend ? /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsx(\"h2\", {\n        className: \"font-weight-bold\",\n        style: {\n          color: '#fff'\n        },\n        children: \"Check your email\"\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        style: {\n          color: '#fff'\n        },\n        children: [`Nous venons de vous envoyer un e-mail`, /*#__PURE__*/_jsx(\"br\", {}), \" \", `avec un lien pour réinitialiser votre mot de passe!`]\n      })]\n    }) : /*#__PURE__*/_jsx(\"form\", {\n      onSubmit: handleSubmit(onSubmit),\n      className: \"d-flex justify-content-center align-items-center\",\n      children: /*#__PURE__*/_jsxs(Card, {\n        style: {\n          width: '450px'\n        },\n        children: [/*#__PURE__*/_jsx(\"small\", {\n          style: {\n            font: 'normal normal bold 14px/16px Ubuntu',\n            margin: '10px auto 0px auto'\n          },\n          children: \"Remplissez le formulaire\"\n        }), /*#__PURE__*/_jsxs(CardBody, {\n          children: [/*#__PURE__*/_jsx(Sinput, {\n            label: \"Email\",\n            icon: \"ni ni-email-83\",\n            placeholder: \"Entrez votre adresse email\",\n            type: \"email\",\n            register: register,\n            name: \"email\",\n            append: true\n          }), errors.email && /*#__PURE__*/_jsx(\"div\", {\n            className: \"text-muted font-italic\",\n            children: /*#__PURE__*/_jsx(\"span\", {\n              className: \"text-danger font-weight-700\",\n              children: errors.email.message\n            })\n          }), /*#__PURE__*/_jsx(Captcha, {\n            recaptchaRef: recaptchaRef,\n            onChange: executeCaptcha\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"text-center\",\n            children: [errormsg && /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-muted font-italic\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                className: \"text-danger font-weight-700\",\n                children: errormsg\n              })\n            }), successmsg && /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-muted font-italic\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                className: \"text-success font-weight-700\",\n                children: successmsg\n              })\n            }), /*#__PURE__*/_jsx(Button, {\n              className: \"mt-3 mb-1\",\n              type: \"submit\",\n              style: {\n                width: '50%',\n                backgroundColor: '#679966',\n                borderColor: '#679966'\n              },\n              children: \"Envoyer l'e-mail\"\n            })]\n          })]\n        })]\n      })\n    })]\n  });\n}\n\nForgotPassword.layout = Bleu;\nexport default ForgotPassword;","map":null,"metadata":{},"sourceType":"module"}