{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _defineProperty from \"/Users/apple/Documents/Projects/itguymax/shakazz/dev/shakaa-web-app-new-version/shakazz-web/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/Users/apple/Documents/Projects/itguymax/shakazz/dev/shakaa-web-app-new-version/shakazz-web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/apple/Documents/Projects/itguymax/shakazz/dev/shakaa-web-app-new-version/shakazz-web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useRef, useState } from \"react\";\nimport { useRouter } from 'next/router';\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport { login } from '../../services/auth.service'; // reactstrap components\n\nimport { Button, Card, CardHeader, CardBody, Form, Row } from \"reactstrap\"; // layout for this page\n\nimport Auth from \"../../layouts/Auth.js\";\nimport Sinput from \"../../components/forms/Sinput\";\nimport Captcha from \"../../components/Captcha\";\nimport { loginSchema } from \"../../validations\";\n\nfunction Login() {\n  var _jsx2;\n\n  var _useForm = useForm({\n    resolver: yupResolver(loginSchema)\n  }),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      errors = _useForm.errors;\n\n  var router = useRouter();\n  var recaptchaRef = useRef();\n\n  var _useState = useState(false),\n      show = _useState[0],\n      setShow = _useState[1];\n\n  var _useState2 = useState(false),\n      verified = _useState2[0],\n      setVerified = _useState2[1];\n\n  var _useState3 = useState(false),\n      submitting = _useState3[0],\n      setSubmitting = _useState3[1];\n\n  var _useState4 = useState(null),\n      errormsg = _useState4[0],\n      setErrormsg = _useState4[1];\n\n  var _useState5 = useState(null),\n      successmsg = _useState5[0],\n      setSuccessmsg = _useState5[1];\n\n  var handleToggleshow = function handleToggleshow() {\n    return setShow(!show);\n  };\n\n  var executeCaptcha = function executeCaptcha() {\n    return setVerified(!verified);\n  };\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n      var userdata, password, userName, datares, _data, error, success, message;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              console.log(\"submit\");\n\n              if (!verified) {\n                _context.next = 20;\n                break;\n              }\n\n              setSubmitting(true);\n              password = data.password, userName = data.userName;\n              userdata = {\n                password: password,\n                userName: userName\n              };\n              _context.prev = 5;\n              _context.next = 8;\n              return login(userdata);\n\n            case 8:\n              datares = _context.sent;\n              console.log('login data', datares);\n              _data = datares.data, error = datares.error, success = datares.success, message = datares.message;\n\n              if (error && !success) {\n                setSuccessmsg(null);\n                setErrormsg(message);\n              } else {\n                setErrormsg(null);\n                setSuccessmsg(message);\n                router.push('/portal/dashboard');\n              }\n\n              console.log(\"data\", _data);\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](5);\n              console.log(\"error\", _context.t0);\n\n            case 18:\n              _context.next = 21;\n              break;\n\n            case 20:\n              alert(\"Vous  n'Ãªtes pas humain\");\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 15]]);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsx(Row, {\n      children: /*#__PURE__*/_jsxs(Card, {\n        className: \"bg-white container border-0\",\n        style: {\n          minWidth: '100%'\n        },\n        children: [/*#__PURE__*/_jsx(CardHeader, {\n          className: \"bg-transparent px-lg-5 \",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"text-muted mt-2 mb-1\",\n            children: [/*#__PURE__*/_jsx(\"h2\", {\n              style: {\n                marginBottom: '0px'\n              },\n              className: \"text-md-right mb-md-4\",\n              children: \"Inscription\"\n            }), /*#__PURE__*/_jsx(\"a\", {\n              style: {\n                font: 'normal normal bold 42px/48px Ubuntu',\n                color: '#121212'\n              },\n              onClick: function onClick(e) {\n                return e.preventDefault();\n              },\n              children: \"Hi, welcome back\"\n            })]\n          })\n        }), /*#__PURE__*/_jsx(CardBody, {\n          className: \"px-lg-5 py-lg-2\",\n          children: /*#__PURE__*/_jsxs(Form, {\n            role: \"form\",\n            onSubmit: handleSubmit(onSubmit),\n            children: [/*#__PURE__*/_jsx(Sinput, {\n              label: \"Nom d'utilisateur\",\n              icon: \"far fa-user\",\n              placeholder: \"Nom d'utilisateur\",\n              type: \"text\",\n              register: register,\n              name: \"userName\",\n              append: true\n            }), errors.userName && /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-muted font-italic\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                className: \"text-danger font-weight-700\",\n                children: errors.userName.message\n              })\n            }), /*#__PURE__*/_jsx(Sinput, (_jsx2 = {\n              label: \"Mot de passe\",\n              icon: \"fa fa-user\",\n              placeholder: \"Entrer votre mot de passe\",\n              type: show ? \"text\" : \"password\",\n              register: register,\n              name: \"password\"\n            }, _defineProperty(_jsx2, \"icon\", show ? \"fa fa-eye\" : \"fa fa-eye-slash\"), _defineProperty(_jsx2, \"handleToggleshow\", handleToggleshow), _defineProperty(_jsx2, \"append\", true), _jsx2)), errors.password && /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-muted font-italic\",\n              children: /*#__PURE__*/_jsx(\"span\", {\n                className: \"text-danger font-weight-700\",\n                children: errors.password.message\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-right \",\n              children: /*#__PURE__*/_jsx(\"a\", {\n                href: \"/auth/forgotPassword\",\n                onClick: function onClick(e) {\n                  return router.prefetch('/auth/forgotPassword');\n                },\n                children: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"text-muted\",\n                  children: \"Mot de passe oubli\\xE9?\"\n                })\n              })\n            }), /*#__PURE__*/_jsx(Captcha, {\n              recaptchaRef: recaptchaRef,\n              onChange: executeCaptcha\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"text-center\",\n              children: [errormsg && /*#__PURE__*/_jsx(\"div\", {\n                className: \"text-muted font-italic\",\n                children: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"text-danger font-weight-700\",\n                  children: errormsg\n                })\n              }), successmsg && /*#__PURE__*/_jsx(\"div\", {\n                className: \"text-muted font-italic\",\n                children: /*#__PURE__*/_jsx(\"span\", {\n                  className: \"text-success font-weight-700\",\n                  children: successmsg\n                })\n              }), /*#__PURE__*/_jsx(Button, {\n                className: \"mt-3 mb-1\",\n                type: \"submit\",\n                style: {\n                  width: '50%',\n                  backgroundColor: '#679966',\n                  borderColor: '#679966'\n                },\n                children: \"S'identifier\"\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                children: [/*#__PURE__*/_jsx(\"a\", {\n                  href: \"/auth/register\",\n                  onClick: function onClick(e) {\n                    return e.preventDefault();\n                  },\n                  children: /*#__PURE__*/_jsx(\"small\", {\n                    children: \"Vous n'avez pas encore de compte?\"\n                  })\n                }), \" \", /*#__PURE__*/_jsx(\"a\", {\n                  href: \"/auth/register\",\n                  children: /*#__PURE__*/_jsx(\"small\", {\n                    className: \"text-bold font-weight-bold ml-1\",\n                    children: \"S'inscrire\"\n                  })\n                })]\n              })]\n            })]\n          })\n        })]\n      })\n    })\n  });\n}\n\nLogin.layout = Auth;\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}